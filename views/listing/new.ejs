<% layout("layouts/boilerplate.ejs") -%>

<div class="container mt-4">
  <div class="row justify-content-center">
    <div class="col-12 col-md-10 col-lg-8"> 
      <div class="card border-0 shadow-lg p-4" style="border-radius: 15px;"> 
        <div class="card-header bg-primary text-white text-center border-0" style="border-radius: 15px 15px 0 0; margin: -1.5rem -1.5rem 1.5rem -1.5rem;">
          <h3 class="mb-0"><i class="fas fa-plus-circle me-2"></i>Add New Product</h3>
        </div>
        <form method="POST" action="/listings" enctype="multipart/form-data" class="needs-validation" novalidate>

          <div class="mb-4">
            <label class="form-label">Product Name:</label>
            <input name="product[name]" type="text" placeholder="Enter product name" class="form-control" required>
            <div class="invalid-feedback">Please enter a product name.</div>
          </div>

          <div class="mb-4">
            <label class="form-label">Description:</label>
            <textarea name="product[description]" rows="3" placeholder="Enter product description" class="form-control" required></textarea>
            <div class="invalid-feedback">Please enter a description.</div>
          </div>

          <div class="mb-4">
            <label class="form-label">Brand (Optional):</label>
            <input name="product[brand]" type="text" placeholder="Enter brand name" class="form-control">
          </div>

          <div class="row">
            <div class="col-md-6">
              <div class="mb-4">
                <label class="form-label">Original Price (₹):</label>
                <input name="product[originalPrice]" type="number" placeholder="Enter original price" class="form-control" required>
                <div class="invalid-feedback">Please enter original price.</div>
              </div>
            </div>
            <div class="col-md-6">
              <div class="mb-4">
                <label class="form-label">Selling Price (₹):</label>
                <input name="product[price]" type="number" placeholder="Enter selling price" class="form-control" required>
                <div class="invalid-feedback">Please enter selling price.</div>
              </div>
            </div>
          </div>

          <div class="mb-4">
            <label class="form-label">Stock Quantity:</label>
            <input name="product[stock]" type="number" placeholder="Enter stock quantity" class="form-control" required>
            <div class="invalid-feedback">Please enter stock quantity.</div>
          </div>

          <div class="mb-4">
            <label class="form-label">Product Images (Up to 5):</label>
            <input name="product[images]" type="file" class="form-control" multiple accept="image/*" required>
            <div class="invalid-feedback">Please select at least one image.</div>
            <small class="text-muted">You can select multiple images by holding Ctrl (or Cmd on Mac)</small>
          </div>

          <div class="mb-4">
            <label class="form-label">Category:</label>
            <select name="product[category]" class="form-select" required>
              <option value="">-- Select Category --</option>
              <option value="Electronics" <%= category === 'Electronics' ? 'selected' : '' %>>Electronics</option>
              <option value="Clothing" <%= category === 'Clothing' ? 'selected' : '' %>>Clothing</option>
              <option value="Home & Garden" <%= category === 'Home & Garden' ? 'selected' : '' %>>Home & Garden</option>
              <option value="Sports" <%= category === 'Sports' ? 'selected' : '' %>>Sports</option>
              <option value="Books" <%= category === 'Books' ? 'selected' : '' %>>Books</option>
              <option value="Beauty & Health" <%= category === 'Beauty & Health' ? 'selected' : '' %>>Beauty & Health</option>
              <option value="Toys & Games" <%= category === 'Toys & Games' ? 'selected' : '' %>>Toys & Games</option>
              <option value="Automotive" <%= category === 'Automotive' ? 'selected' : '' %>>Automotive</option>
              <option value="Jewelry" <%= category === 'Jewelry' ? 'selected' : '' %>>Jewelry</option>
              <option value="Pet Supplies" <%= category === 'Pet Supplies' ? 'selected' : '' %>>Pet Supplies</option>
              <option value="Office Supplies" <%= category === 'Office Supplies' ? 'selected' : '' %>>Office Supplies</option>
              <option value="Baby Products" <%= category === 'Baby Products' ? 'selected' : '' %>>Baby Products</option>
            </select>
            <div class="invalid-feedback">Please select a category.</div>
          </div>

          <div class="d-grid mt-4">
            <button class="btn btn-primary btn-lg" type="submit">
              <i class="fas fa-plus-circle me-2"></i>Add Product
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>

<style>
.form-control, .form-select {
  border: 2px solid #dee2e6 !important;
  border-radius: 8px !important;
  padding: 12px 15px !important;
  font-size: 16px !important;
  transition: all 0.3s ease;
  background-color: #ffffff !important;
}

.form-control:focus, .form-select:focus {
  border-color: #0d6efd !important;
  box-shadow: 0 0 0 0.25rem rgba(13, 110, 253, 0.25) !important;
  outline: none !important;
}

.form-control:hover, .form-select:hover {
  border-color: #adb5bd !important;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1) !important;
}

.form-label {
  font-weight: 600 !important;
  color: #495057 !important;
  margin-bottom: 8px !important;
  font-size: 14px !important;
  text-transform: uppercase !important;
  letter-spacing: 0.5px !important;
}

.form-control::placeholder {
  color: #6c757d !important;
  opacity: 0.7 !important;
}

.btn-primary {
  transition: all 0.3s ease;
  border: none !important;
  font-weight: 600 !important;
  text-transform: uppercase !important;
  letter-spacing: 0.5px !important;
}

.btn-primary:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 15px rgba(13, 110, 253, 0.3);
}

.card {
  border: 1px solid #e9ecef !important;
  box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1) !important;
}

.invalid-feedback {
  font-size: 13px !important;
  font-weight: 500 !important;
  color: #dc3545 !important;
}

.text-muted {
  color: #6c757d !important;
  font-size: 13px !important;
}
</style>

<script>
// Bootstrap form validation
(function () {
  'use strict'
  const forms = document.querySelectorAll('.needs-validation')
  Array.from(forms).forEach(form => {
    form.addEventListener('submit', event => {
      if (!form.checkValidity()) {
        event.preventDefault()
        event.stopPropagation()
      }
      form.classList.add('was-validated')
    }, false)
  })
})()
</script>
